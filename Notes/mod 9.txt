M9 L1
XML DTD and HTML5

Lecture Outline
| XML Type Definition and Validation
| Document Type Definition (DTD)
| HTML5 as a Case Study

Why Do We Need Type and Schema Definition?
What is a well-formed XML document?

<time>
<hour>12</hour>
<minute>72</minute>
<second>-5</second>
</time>

<time>
<hour>18</hour>
<minute>59</minute>
<second>2</second>
</time>

Unique root
Tags may not overlap
Other restrictions on characters and words

Is this a wellformed XML
element?

Is this instance
OK?

3

Apply Business Rules to Validate Data
<time>
<hour>18</hour>
<minute>59</minute>
<second>2</second>
</time>
XML
Rule
Validator

Data OK
Valid?

hour: integer between 01 and 12
23
minutes: integer between 0 and 59
second: integer between 0 and 59
Rules

Data not OK

• DTD
• XML Schema

4

XML Document Type Definition (DTD)
|

A piece of information can be encoded in an XML
document in different ways.

|

When the information is transferred from the source to
its destination, the receiver needs to know how the
document is structured and need to check if the content
is indeed compliant with the structure.

|

DTD provides the organization and rules for the XML
document instance, or it holds information about the
structure or the grammar of an XML document.

|

A DTD file can be defined in a separate file
(external/global DTD) or within the XML document itself
(internal/local DTD).
5

Syntax Definition of DTD
◼

<!DOCTYPE root-element
[
doctype-declarations
]>
It consists of the name of the root element and a list of
document type declarations, each of which is:
◼ <!ELEMENT element-name content-model>
defines a pattern that associates a content model to
an element of the given name;
◼ Content-model: You can define your content model to allow:
◼ EMPTY: no content is allowed for the element
◼ ANY: any content is allowed for the element (CDATA)
◼ (#PCDATA | element-name | ...)*: parsed character data
6

Syntax Definition of DTD (contd.)
|

Expression over element names when defining an
element:
- choice: (a | b | c)
- sequence: (a, b, c)
- optional: a?
- zero or more: b*
- one or more: c+

7

Example of DTD within an XML file
, sequence
DTD
File
defining
the rules

XML file
(Instance)
complies to
the DTD
file

<?xml version = ‘1.0’ encoding=‘utf-8’>
<!DOCTYPE instructor [
<!ELEMENT instructor (name, (course+), OfficeHours, (phone | email))>
<!ELEMENT name (first, (middle?), last)>
<!ELEMENT course (#PCDATA)>
+ at least one
<!ELEMENT OfficeHours (#PCDATA)>
<!ELEMENT phone (#PCDATA)>
| OR
<!ELEMENT email (#PCDATA)>
? optional
<!ELEMENT first (#PCDATA)>
<!ELEMENT middle (#PCDATA)>
<!ELEMENT last (#PCDATA)>
]>
Does not support
<instructor>
“integer”
<name>
<first>Yinong</first>
<last>Chen</last>
</name>
<course>Distributed Software Development</course>
<course>Introduction to Programming Languages</course>
<officeHours>4</officeHours>
<email>yinong@asu.edu</email>
</instructor>

8

Example of Using an External DTD file
<!DOCTYPE instructor [
<!ELEMENT instructor (name, (course+), OfficeHours, (phone | email))>
<!ELEMENT name (first, (middle?), last)>
<!ELEMENT course (#PCDATA)>
<!ELEMENT OfficeHours (#PCDATA)>
<!ELEMENT phone (#PCDATA)>
<!ELEMENT email (#PCDATA)>
<!ELEMENT first (#PCDATA)>
<!ELEMENT middle (#PCDATA)>
<!ELEMENT last (#PCDATA)>
]>

instructor.dtd

<?xml version = ‘1.0’ encoding=‘utf-8’>
<!DOCTYPE instructor SYSTEM “http://venus.sod.asu.edu/WSRepository/xml/instructor.dtd”>
<instructor>
<name>
<first>Yinong</first> <last>Chen</last>
</name>
<course>Distributed Software Development</course>
<officeHours>4</officeHours>
<phone>480-965 2769</phone>
9
</instructor>

Defining Attributes for an Element
instructor.dtd

<!EMEMENT course (#PCDATA)>
<!ATTLIST course level
CDATA
text
CDATA
campus CDATA
>

#REQUIRED
#IMPLIED
“Tempe”
Attribute is
optional, no
default
provided

Default value if
not provides
Any data
allowed

<course
level = “senior”
text = “Service-Oriented Architecture & Computing”
campus = “Downtown” >
Distributed Software Development
</course>

Must be
PCDATA, see
previous page

10

DTD Vocabulary (Namespace)
New vocabulary

CDATA

course

name
NMTOKEN

instructor

last
first

ID

ELEMENT

officeHours

ENTITY
#PCDATA

ATTLIST

This is the vocabulary that
DTD provides to define your
new vocabulary

Values for each
name: must be
#PCDATA
Type
11

XML Validation Using DTD

instructor.dtd
User Defined DTD

instructor.xml
User defined
Validate

The xml document
must conform with the
rules described
in instructor.dtd

12

Case Study: HTML5 Definition
Reference: http://www.w3schools.com/html/html5_intro.asp

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title> Doc Title </title>
</head>

<body>
Content of the document......
</body>

• New semantic elements like
<header>, <footer>, <article>, and
<section>.
• New form control attributes like
number, date, time, calendar, and
range.
• New graphic elements like: <svg>
and <canvas>.
• New multimedia elements like:
<audio> and <video>.

JavaScript and JQuery API Calls

</html>
Become a Web Application
Development Language

13

HTML5 JavaScript API Library
Reference: http://html5index.org/
◼

Web communication protocols
◼

◼
◼

Web Sockets
Messaging, and
WebRTC
(Web Real-Time Communication)

ASU VIPLE Web Simulator:
https://venus.sod.asu.edu/VIPLE/Web2DSimulator/

Drag and Drop, Fullscreen
◼ Canvas, SVG, WebGL
◼ Animation Timing, Media, Pointer Lock, Web Audio
◼ File API, File System API, Indexed DB, Offline, Web Storage
Offline and Storage
◼ Browser, Shadow DOM, Typed Arrays, Web Workers
Restricted DOM for Web components
◼ DOM and JQuery
◼ CSS Object Model, Selectors
Read text section 4.6.5 for
◼

a programming example.

14

ASU VIPLE Web Simulator:
https://venus.sod.asu.edu/VIPLE/Web2DSimulator/

// Right-Click, View Page Source
// Code JavaScript behind the HTML5 GUI
//**********************************************************
// Start of Drawing Functions
//**********************************************************
function drawMazeAndRectangle(rectX, rectY) {
makeWhite(0, 0, canvas.width, canvas.height);
mazeImg.onload = function() {
context.drawImage(mazeImg, 0, 0);
// Draws robot to the canvas at current (x,y) coordinate
drawRectangleToRobotCanvas();
};;
}
function drawRobot2() {
twoRobots = true;
var robot2 = document.getElementById("robot2");
var robot2Context = robot2.getContext("2d");
robot2Context.clearRect(0, 0, canvas.width, canvas.height);
robot2MiddleX = currRectX2 + rWidth / 2;
robot2MiddleY = currRectY2 + rHeight / 2;

15

WebGL, Canvas, or SVG? Choose the right API
https://msdn.microsoft.com/en-us/library/dn265058%28v=vs.85%29.aspx?f=255&MSPPError=-2147217396

Canvas is the typical choice for most HTML5 games.
It's simple and speedy, particularly for games with many
objects. ASU VIPLE Web Simulator uses Canvas.
◼ SVG: While Canvas provides simplicity and speed,
SVG provides flexibility. For example: Each graphic
object is part of the DOM tree for flexible access, and
each graphic object in the game can have one or more
associated event handlers for process.
◼ WebGL: If you’re already familiar with OpenGL,
you can use WebGL for a simple 2D game. If you're
not, this API is more complex than you need for a
simple game.
16
◼

M9 L2
XML Schema

Lecture Outline
| XML Schema Definition (XSD)
| XML Type Definition
- Simple Types
- Complex Types

| XML Namespace
| Case Study: Using XML Schema to Define
a New Language
2

What is XML Schema and Why?
Like DTD, XML Schema defines an XML vocabulary for
expressing your data's business rules
◼ XML Schema is a more powerful alternative to DTD that defines
the structure (grammar) of an XML document. The advantages of
the schema over DTD include:
◼ DTD is not XML-based and requires separate tools for
processing DTD documents, while XML Schema is XMLbased. The same tools can be used for parsing and processing
XML documents, as well as XML Schema documents.
◼ XML Schema is extendable and reusable. One can easily add
new types, restricting existing types, and combine existing
schemas.
◼ DTD is limited to string type of data. XML schema can define
many different types similar to a typical programming
language, such as integer, float, string, and structures.
3
◼

XML Schema Definition (XSD)
◼

In an XML document, the schema is introduced through an element
with an opening tag <xsd:schema>, which is the root element, and

◼

with a number of optional attributes, e.g., referring to the source and
version:
<schema xmlns ="http://www.w3.org/2000/10/XMLSchema" version = "1.0">

◼

This schema namespace includes elements and datatypes that can be
used for constructing different schemas:
schema
◼ element
◼ complexType
◼ sequence
◼

boolean
◼ integer
◼ string
◼

4

Types Defined in XML Schema W3C 2001
Forty-four (44) built-in types, in which 19 are simple
(primitive) and 25 are derived complex types.
◼ User can define further types of simple and complex
◼ Complex types are defined using simple and complex
types.
◼ Type inheritance: Extend one type from an existing
type.
◼

5

Definition of New Simple Types
Use an element to define a new type with a name and
an associated type
◼ Use a single built-in type to define a new type
◼ Use a namespace to tell where the element and type
used come from.
◼

<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd=“http://www.w3.org/2001/XMLSchema”>
namespaces

<xsd:element name="Title" type="xsd:string"/>
<xsd:element name="Author" type="xsd:string"/>
<xsd:element name=“Date" type="xsd:date"/>

<xsd:element name="ISBN" type="xsd:string"/>
<xsd:element name=“Publisher" type=“xsd:string "/>
</xsd:schema>

6

root

Example: XML Schema of A Bookstore

7
namespaces

complexType

complexType

simpleType

<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
targetNamespace= "http://venus.sod.asu.edu/WSRepository/xml"
elementFormDefault="qualified" attributeFormDefault="unqualified">
<xsd:element name="Book">
<xsd:complexType>
<xsd:sequence>
<xsd:element name="Title" type="xsd:string"
minOccurs="1" maxOccurs="1"/>
<xsd:element name="Author" type="xsd:string"
minOccurs="1" maxOccurs="unbounded"/>
<xsd:element name="Year" type="xsd:integer"
minOccurs="0" maxOccurs="1"/>
<xsd:element name="ISBN" type="xsd:string"
minOccurs="0" maxOccurs="1"/>
</xsd:sequence>
</xsd:complexType>
</xsd:element>
<xsd:element name="Bookstore">
<xsd:complexType>
<xsd:sequence>
<xsd:element name="Book" minOccurs="1" maxOccurs="unbounded"/>
</xsd:sequence>
<xs:attribute name= “Address" type="xsd:string" use="required"/>
</xsd:complexType>
</xsd:element>
<xsd:element name= "First" type="xsd:string"/>
<xsd:element name= "Last" type="xsd:string"/>
7
</xsd:schema>

Definition of Complex Types
Use an element to define a new type with a name;
◼ Use sub elements to define the components of the new
type;
◼ Specify the allowed number of occurrences of each
component;
◼ Use namespaces to tell where the used element and
types come from;
◼ Use different kinds of combination options.
◼

Sequence
❑ Choice
❑ all
❑

8

Definition of complexType
You can define the members of a complexType using three different
options:
◼ sequence: All members must appear in the given order
◼ all: All members must appear (unless minOccurs= "0" ), but can be
in any order
◼ choice: Only one of the list members is allowed
<xsd:element name="Book">
<xsd:complexType>
<xsd: sequence
>
all
<xsd:element name="Title" minOccurs="1" maxOccurs="1"/>
<xsd:element name="Author" minOccurs="1" maxOccurs="unbounded"/>
<xsd:element name=“Year" minOccurs= "0" maxOccurs="1"/>
<xsd:element name="ISBN" minOccurs= "0" maxOccurs="1"/>
</xsd: sequence
>
all
</xsd:complexType>
9

Choice of complexType
<xsd:element name="Book">
<xsd:complexType>
<xsd:sequence>
<xsd:element name="Title" />
<xsd:element name="Author" />
<xsd:element name=“Year" />
<xsd:choice>
<xsd:element name="ISBN-10" />
<xsd:element name="ISBN-13" />
</xsd:choice>
</xsd:sequence>
</xsd:complexType>
</xsd:element name="Book">

10

Namespaces
A namespace is declared as an attribute of an element.
◼ It binds a prefix name (qualifier) to a schema
definition, and then uses that prefix wherever required;
◼ It is not mandatory to declare namespaces at the root
element; Namespaces could be declared at any element
in the XML document;
◼ The scope of a declared namespace applies to the entire
content of that element;
◼ Namespace can be overridden: An inner namespace
declaration with the same prefix name (qualifier) will
override the outer namespace.
◼

11

Namespaces

schema
◼ element
◼ complexType
◼ sequence
◼ boolean
◼ integer
◼ string
◼

<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
targetNamespace="http://venus.sod.asu.edu/WSRepository/xml"
xmlns="http://venus.sod.asu.edu/WSRepository/xml/bookstore.xsd"
elementFormDefault="qualified"
attributeFormDefault="unqualified">
4 combinations
This is a directive to any instance
documents which conform to this
schema: Any elements used by
the instance document must be
namespace qualified. But the
attributes do not need to be
qualified

Define this namespace as
the default namespace.
The names in the default
namespace do not need
to be qualified

Inherit all names from
XMLSchema, plus
types being defined in
this schema
Bookstore
Book
Title
Author
Date
ISBN
Publisher
12

Target Namespace
http://www.w3.org/2001/XMLSchema

schema
◼ element
◼ complexType
◼ sequence
◼ boolean
◼ integer
◼ string
◼

http://venus.sod.asu.edu/WSRe
pository/xml
Bookstore
Book
Title
Author
Date
ISBN
Publisher

targetNamespace =
"http://venus.sod.asu.edu/WSRepository/xml/"

schema
◼ element
◼ complexType
◼ sequence
◼ boolean
◼ integer
◼ String
◼

merge

Bookstore
Book
Title
Author
Date
ISBN
Publisher

13

Default Namespace
It is painful to repeatedly qualify an element or
attribute you wish to use from a namespace;
◼ You can declare one default namespace;
◼ Important: at any point in time, there can be one
default namespace only;
◼ Declaring a default namespace means that any
element within the scope of the namespace will be
qualified implicitly, if it is not already qualified
explicitly using a prefix.
◼ The name of the default namespace is simply xmlns
◼

xmlns = "http://venus.sod.asu.edu/WSRepository/xml/bookstore.xsd"
14

Choice of the default namespace
<?xml version="1.0" encoding="UTF-8"?>
<schema xmlns="http://www.w3.org/2001/XMLSchema"
targetNamespace="http://venus.sod.asu.edu/WSRepository/xml/"
xmlns:bs="http://venus.sod.asu.edu/WSRepository/xml/bookstore.xsd"
elementFormDefault="qualified" attributeFormDefault="unqualified">

The bookstore namespace was the
default, and it is no longer default
now. The elements defined in it must
be qualified by “bs”.

Define the XML Schema
as the default
namespace. The names
in the default namespace
do not need to be
qualified

15

Example: XML Schema of A Bookstore
No default

<?xml version="1.0" encoding="UTF-8"?>
namespaces
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
targetNamespace= "http://venus.sod.asu.edu/WSRepository/xml/"
elementFormDefault="qualified" attributeFormDefault="unqualified">
<xsd:element name="Bookstore">
<xsd:complexType>
<xsd:sequence>
<xsd:element name="Book" minOccurs="1" maxOccurs="unbounded"/>
</xsd:sequence>
</xsd:complexType>
</xsd:element>
<xsd:element name="Book">
<xsd:complexType>
<xsd:sequence>
<xsd:element name="Title" type="xsd:string" minOccurs="1" maxOccurs="1"/>
<xsd:element name="Author" type="xsd:string" minOccurs="1" maxOccurs="unbounded"/>
<xsd:element name="Year" type="xsd:string" minOccurs="0" maxOccurs="1"/>
<xsd:element name="ISBN" type="xsd:string" minOccurs="0" maxOccurs="1"/>
<xsd:element name="Publisher" type="xsd:string" minOccurs="0" maxOccurs="1"/>
</xsd:sequence>
</xsd:complexType>
</xsd:element>
<xsd:element name=“First" type="xsd:string"/>
<xsd:element name=“Last" type="xsd:string"/>
16
</xsd:schema>

Better Choice of Default Namespace

Complex
Type

Complex
Type

Simple
Type

Default
<?xml version="1.0" encoding="UTF-8"?>
namespace
<schema xmlns="http://www.w3.org/2001/XMLSchema"
targetNamespace= "http://venus.sod.asu.edu/WSRepository/xml/"
xmlns:bs ="http://venus.sod.asu.edu/WSRepository/xml/bookstore.xsd"
elementFormDefault="qualified" attributeFormDefault="unqualified">
<element name="Bookstore">
<complexType>
<sequence>
<element name="Book" minOccurs="1" maxOccurs="unbounded"/>
</sequence>
</complexType>
</element>
<element name="Book">
<complexType>
<sequence>
<element name="Title" type="xsd:string" minOccurs="1" maxOccurs="1"/>
<element name="Author" type="xsd:string" minOccurs="1" maxOccurs="unbounded"/>
<element name="Year" type="xsd:string" minOccurs="0" maxOccurs="1"/>
<element name="ISBN" type="xsd:string" minOccurs="0" maxOccurs="1"/>
</sequence>
</complexType>
</element>
<element name=“First" type="string"/>
<element name=“Last" type="string"/>
<element name=“Size" type=“bs:DIN"/>
17
</schema>

Using a Schema in an Instance
xmlns:
Default XML
namespace

xsi:
XML
Schema
Instance

<?xml version="1.0"?>
<Bookstore xmlns ="http://venus.sod.asu.edu/WSRepository/xml/bookstore.xsd"
xmlns:bs ="http://venus.sod.asu.edu/WSRepository/xml/bookstore.xsd"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://venus.sod.asu.edu/WSRepository/xml/bookstore.xsd">
<Book>
<Title>Introduction to Programming Languages</Title>
<Author>Yinong Chen</Author>
xsi
<Author>Gennaro De Luca</Author>
is used to
<Year>2022</Year>
define the
location
<ISBN> 978-1-7924-9416-1</ISBN>
<Size>10x8</Size>
</Book>
...
</Bookstore>

18

Default Namespace and Attributes
Prefixed namespace and the default namespace do not
apply to attributes within the element;
◼ To apply a namespace to an attribute, the attribute must
be explicitly qualified.
◼ In the example below, the attribute "edition" has no
namespace, whereas the attribute "cover" is associated
Default namespace
with the namespace bs.
◼

<Book xmlns = "http://venus.sod.asu.edu/WSRepository/xml/bookstore.xsd">
<Title bs: cover = "paperback" > Programming Languages </Title>
<Author>Yinong Chen</Author>
<Author> Gennaro De Luca </Author>
<Year edition = "2" >2022</Year>
<ISBN> 978-1-7924-9416-1</ISBN>
</Book>

19

element
sequence
boolean
…

Instance

<?xml version="1.0" encoding="UTF-8"?>
<schema xmlns="http://www.w3.org/2001/XMLSchema"
targetNamespace= "http://venus.sod.asu.edu/WSRepository/xml/"
…
<element name="bookstore">
…
</element>
<element name="Book">
…
</element>

<bookstore …>
<Book>
<Title>SOC</Title>
…
</Book>
</bookstore>

element
bookstore
Author
Publisher

boolean integer,
Book
Title
Year
ISBN

User-Defined Schema

schema
complexType
choice
all
integer string

vocabulary

XML Schema
Namespace
http://www.w3.org/2001/
XMLSchema

vocabulary

Summary of XML Schema Example

20

Case Study
https://vlab.noaa.gov/web/mdl/ndfd-web-services
https://graphical.weather.gov/xml/SOAP_server/ndfdXML.htm

Digital Weather Markup Language (DWML)
◼ DWML is an XML language for supporting the
exchange of the National Weather Service’s (NWS)
National Digital Forecast Database (NDFD) data;
◼ Also used in other environmental science applications.
DWML site provides a definition of DWML types
based on restrictions.
◼ Weather forecast services:
http://www.weather.gov/, Enter City, State names
◼ 7-day forecast data downloadable in the format of
◼

http://forecast.weather.gov/MapClick.php?lat=33.43417&lon=-112.05111&FcstType=dwml
21

DWML XML Schema
https://graphical.weather.gov/xml

Namespaces

22

Instance of the Schema: Phoenix Seven-Day
Weather Data Download
http://forecast.weather.gov/MapClick.php?lat=33.43417&lon=-112.05111&FcstType=dwml

23

To Get Forecast from the URL
http://forecast.weather.gov/MapClick.php?lat=33.43417&lon=-112.05111&FcstType=dwml

// The operation takes latitude and longitude as inputs, and obtain 7-day forecast
public void GetForecast(string latitude, string longitude) {
// form the URI
UriBuilder fullUri = new UriBuilder("http://forecast.weather.gov/MapClick.php");
fullUri.Query = "lat=" + latitude + "&lon=" + longitude + "&FcstType=dwml";
// initialize a new WebRequest: RESTful style service access
HttpWebRequest forecastRequest =
(HttpWebRequest)WebRequest.Create(fullUri.Uri);
// set up the state object for the async request
ForecastUpdateState forecastState = new ForecastUpdateState();
forecastState.AsyncRequest = forecastRequest;
// start the asynchronous request
forecastRequest.BeginGetResponse(
new AsyncCallback(HandleForecastResponse), forecastState);
}
24

Process the Forecast Response (XML File)
Asynchronous
invocation

Read Text 10.4.5:
LINQ to XML
Processing

25

M9 L3
XML Validation

Lecture Outline
| XML Validation Classes
| XML Reader with Validation

2

Multiple Levels of Validation
http://validator.w3.org/

XmlSchemaSet
XMLReaderSettings
XMLReader
XMLSchema.xsd
schema-for-schemas
W3C Standard

bookstore.xsd
Schema doc
User defined

bookstore.xml
User defined
Validate

The xml instance
document
conforms with the
rules described
in bookstore.xsd and
in W3C standard

Validate

bookstore.xsd
is a valid schema
document, i.e., it
conforms with the rules
described in the
schema-forschemas

3

XML Validation Using DTD and XSD
http://validator.w3.org/

bookstore.xml
User defined

XmlSchemaSet
XMLReaderSettings
XMLReader

Validate
The xml instance
document
conforms with the
rules described
in bookstore.xsd or
bookstore.dtd

User defined
bookstore.xsd
bookstore.dtd

4

Validation Classes in .Net Framework
◼

Three classes are used, and they support both DTD and XSD:

XmlSchemaSet, XMLReaderSettings, XMLReader for Validation
1. Use XmlSchemaSet object to hold the schemas
2. Link the schema set to XMLReaderSettings object

3. Use XmlReader to create a reader object that associates the XML
file to be validated with the XMLReaderSettings object
XmlSchemaSet
to add schemas

XmlReader
Settings
settings

XmlReader
XML
Reader
.Create
Reader object

XML File

5

Using XmlSchemaSet Class to add schemas
using System; using System.Xml;
using System.Xml.Schema; using System.IO;
Do not list .xsd
file as a
namespace of
the .xml file.

public class Sample {
public static void Main() {
// Create the XmlSchemaSet class.
XmlSchemaSet sc = new XmlSchemaSet();
// Add the schema to the collection before performing validation
sc.Add(null, "http://venus.sod.asu.edu/WSRepository/xml/Courses.xsd");
// Define the validation settings.
Schema
XmlReaderSettings settings = new XmlReaderSettings();
definition
settings.ValidationType = ValidationType.Schema;
file
settings.Schemas = sc; // Association
settings

You could
choose
.DTD

6

Using XmlReader.Create Method
Add an event handler
settings.ValidationEventHandler += new
ValidationEventHandler(ValidationCallBack);
// Create the XmlReader object.
xmlCoursesWithErrors.xml
XmlReader reader =
XmlReader.Create("http://venus.sod.asu.edu/WSRepository/xml/Courses.xml", settings);
 XML instance file
 namespaces
// Parse the file.
while (reader.Read()) ;
// will call event handler if invalid
Console.WriteLine("The XML file validation has completed");

}
// Display any validation errors.
private static void ValidationCallBack(object sender, ValidationEventArgs e)
{
Console.WriteLine("Validation Error: {0}", e.Message);
}
}

7

Output with Errors and Without Errors
CoursesWithErrors.xml

Courses.xsd

Courses.xml

Courses.xsd

8

M9 L4
XSL:
Extensible Stylesheet
Language and
XSLT:
XSL Transformations

Lecture Outline
| The Needs of Transformations
| XSL: Extensible Stylesheet Language
| Client-Side Transformation
| Server-Side Transformation
| CSS: Cascading Style Sheets

2

The Needs of Transformation: XSLT and XSL-FO
PDF
An XML
document with a
different structure

XSL-

FO

Special formats

XML document
XSLT
XSLT

name

phone

ID

John

4801234567

1234567890

Joe

6022345678

9876543210

name

ID

phone

John

1234567890

4801234567

Joe

9876543210

6022345678

3

XSL: Extensible Stylesheet Language
http://www.w3.org/TR/xsl/

HTML: "Format without Structure"
◼ Typesetting language
◼ Not extensible
◼ XML: "Structure Without Format"
◼ Defines "elements" using "tags"
◼ Creates hierarchical structure of information set
◼ XSL is a set of language technologies for defining XML
document transformation and presentation
◼ XSLT: XSL Transformations
◼ XSL Formatting Objects or XSL-FO, is a markup language
for XML document formatting which is most often used for
generating PDFs
◼ XSLT is a built-in component in ESB Enterprise Service Bus 4
◼

XSLT: XSL Transformations
◼

XSL is a declarative (functional) programming <xsl:choose>
<xsl:when condition">
language with constructs such as
html statements
</xsl:when>
◼ if
<xsl:when test="condition">
html statements
</xsl:when>
◼ choose-when-otherwise (switch)
<xsl:otherwise>
html statements
◼ for-each
</xsl:otherwise>
</xsl:choose>

◼

XSL is Turing complete in theory, and thus can be used for
programming any task, but limited in practice
◼ Creates formatted output

◼

Transforms one XML structure to another

◼

Transforms XML to HTML: Adding HTML Format to
XML Structure
5

Weather.xsl that defines: variable and if
https://w1.weather.gov/xml/current_obs/latest_ob.xsl

6

XML Transformations Using a Stylesheet

Courses.xml

Courses.html
XSLT
Processor

Courses.xsl

CoursesT.xml

7

Converting XML to HTML on Client (Browser)
◼

Put Courses.xml and Courses.xsl into a Website, e.g.,
in
C:\Inetpub\wwwroot (IIS virtual directory); or
http://venus.sod.asu.edu/WSRepository/xml/Courses.xml

◼

Using the browser to convert the xml file into html by:
◼ Test Courses.xml, with and without this line:
<?xml-stylesheet type="text/xsl" href="Courses.xsl"?>

and open the file by typing the address:
C:\Inetpub\wwwroot\Courses.xml
◼ Repeat by adding the line
<?xml-stylesheet type="text/xsl" href="Courses.xsl"?>
8

Converting XML to HTML on Client (Browser)
Example: Courses.xml
<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="Courses.xsl"?>
<Courses>
<Course>
<Name>Introduction to Programming
Languages</Name>
<Code>CSE240</Code>
<Level>Sophomore</Level>
<Room>BYAC110</Room>
<Cap>82</Cap>
</Course>
<Course>
<Name>Distributed Software
Development</Name>
<Code>CSE445</Code>
<Level>Senior</Level>
<Room>BYAC210</Room>
<Cap>40</Cap>
</Course>
</Courses>

9

Courses.xsl that defines: for-each
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
<xsl:template match="/">
<html> <body>
<h1>My Courses</h1>
<table border="1">
<tr bgcolor="yellow">
<td><b>Name </b></td>
<td><b>Code</b></td>
Print
<td><b>Level</b></td>
header
<td><b>Room</b></td>
<td><b>Cap</b></td>
</tr>
<xsl:for-each select="Courses/Course">
<xsl:sort select="Name" />
<tr style="font-size: 10pt; font-family: verdana">
<td><xsl:value-of select="Name"/></td>
Print
<td><xsl:value-of select="Code"/></td>
<td><xsl:value-of select="Level"/></td>
header
contents
<td><xsl:value-of select="Room"/></td>
<td><xsl:value-of select="Cap"/></td>
</tr>
</xsl:for-each>
</table>
</body> </html>
</xsl:template>
</xsl:stylesheet>

10

Another Example:
Fallacies.xml: The file to be displayed
<?xml version="1.0"?>
<Fallacies>
<Fallacy>
<Number>1</Number>
<Text>The network is reliable.</Text>
<Author>Bill Joy and Tom Lyon</Author>
</Fallacy>
<Fallacy>
<Number>2</Number>
<Text>Latency is zero.</Text>
<Author>Bill Joy and Tom Lyon</Author>
</Fallacy>
<Fallacy>
<Number>3</Number>
<Text>Bandwidth is infinite.</Text>
<Author>Bill Joy and Tom Lyon</Author>
</Fallacy>
<Fallacy>
<Number>4</Number>
<Text>The network is secure.</Text>
<Author>Bill Joy and Tom Lyon</Author>
</Fallacy>
<Fallacy>

<Number>5</Number>
<Text>Topology does not change.</Text>
<Author>Peter Deutsch</Author>
</Fallacy>
<Fallacy>
<Number>6</Number>
<Text>There is one administrator.</Text>
<Author>Peter Deutsch</Author>
</Fallacy>
<Fallacy>
<Number>7</Number>
<Text>Transport cost is zero.</Text>
<Author>Peter Deutsch</Author>
</Fallacy>
<Fallacy>
<Number>8</Number>
<Text>The network is homogeneous.</Text>
<Author>James Gosling</Author>
</Fallacy>
</Fallacies>
11

Fallacies.xsl: The stylesheet file
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
<xsl:template match="/">
<html> <body>
<h1 style="background-color: blue; color: white; font-size: 18pt; text-align: center">
Eight Fallacies in Distributed Computing
</h1>
<table border="1">
Print
<tr style="font-size: 12pt; font-family: verdana; font-weight: bold">
header
<td style="text-align: center">Number</td>
<td style="text-align: center">Fallacy</td>
<td style="text-align: center">Author</td>
</tr>
<xsl:for-each select="Fallacies/Fallacy">
<xsl:sort select="Number" />
<tr style="font-size: 12pt; font-family: verdana">
<td><i><xsl:value-of select="Number"/></i></td>
Print
<td><xsl:value-of select="Text"/></td>
contents
<td><xsl:value-of select="Author"/></td>
</tr>
</xsl:for-each>
</table>
</body> </html>
</xsl:template>
12
</xsl:stylesheet>

Without
using the
XSL File

13

Demonstration using Client Conversion
Put the two Files into an IIS virtual Directory on
localhost or on server
◼

Using client-side conversion: add a line of directive:
<?xml-stylesheet type="text/xsl" href="Fallacies.xsl"?>
after the first of prolog.

◼

Type the address in your browser:
C:\Inetpub\wwwroot\Fallacies.xml

You can test it on
your Windows IIS

OR, put them in any remote Web server, e.g.:
http://venus.sod.asu.edu/WSRepository/xml/Fallacies.xml
14

The Display of the Page
https://venus.sod.asu.edu/webhome/teaching/cse445/programs/Fallacies.xml
https://venus.sod.asu.edu/webhome/teaching/cse445/programs/Fallacies.xsl

15

Converting XML to HTML on Server Side
Two potential problems with the client-side conversion:
◼ Need to modify the xml file (to reference an xsl file)
◼ Browser dependent
◼ Not all browsers have an embedded XSLT
processor;
◼ Not all versions of the browser has an embedded
XSLT processor.
◼ To ensure that your page can be displayed properly,
you need to write a program the conversion on the
server side: Writing a .aspx file using a program to do
the conversion.
16

Members of XslCompiledTransform Class
Method Name

Description

Equals

Overloaded. Determines whether two Object instances are
equal. (inherited from Object)

GetHashCode

Serves as a hash function for a particular type. (inherited from
Object)

GetType

Gets the Type of the current instance. (inherited from Object)

Load

Overloaded. Loads the XSLT style sheet, including style
sheets referenced in xsl:include and xsl:import elements.

ReferenceEquals

Determines whether the specified Object instances are the same
instance. (inherited from Object)

ToString

Returns a String that represents the current Object. (inherited
from Object)

Transform

Overloaded. Transforms the XML data using the loaded
XSLT style sheet.
17

Do it in C# in Console: Translate XML into html
Command line input:
Fallacies.xml Fallacies.xsl

class MyXSLTApp {
static void Main(string[ ] args) {
if (args.Length < 2) {
Console.WriteLine(“Error: Files required not found");
return;
}
try {
XPathDocument doc = new XPathDocument(args[0]);
XslCompiledTransform xt = new XslCompiledTransform();
xt.Load(args[1]);
xt.Transform(doc, null, Console.Out);
}
catch (Exception ex) {
Console.WriteLine(ex.Message);
}
string x = Console.ReadLine();
}
}

18

Do it in C#: How to do it step by step?
Create a C# Console Application
◼ Copy and Paste the C# code into the application
◼ Build/Compile your program
◼ Choose Visual Studio menu “Project” -> “Properties…”
◼ Click on Debug -> Command Arguments
◼ Enter Fallacies.xml Fallacies.xsl files as the command
line arguments (See next page)
◼ Browse to the Working directory where your
Fallacies.xml and Fallacies.xsl files are located
◼ Run the program
◼ The html file will be generated (see following page).
◼

19

Project → Properties …
Setting Up Command Line Input

20

The output of the program: html file
<html>
<body>
<h1 style="background-color: blue; color: white; font-size: 18pt; text-align: center">
Eight Fallacies in Distributed Computing
</h1>
<table border="1">
<tr style="font-size: 12pt; font-family: verdana; font-weight: bold">
<td style="text-align: center">Number</td>
<td style="text-align: center">Fallacy</td>
<td style="text-align: center">Author</td>
</tr>
<tr style="font-size: 12pt; font-family: verdana">
<td>
<i>1</i>
</td>
<td>The network is reliable.</td>
<td>Bill Joy and Tom Lyon</td>
</tr>
<tr style="font-size: 12pt; font-family: verdana">
<td>
<i>2</i>
</td>
<td>Latency is zero.</td>
<td>Bill Joy and Tom Lyon</td>
</tr>
<tr style="font-size: 12pt; font-family: verdana">
<td>
<i>3</i>
</td>
<td>Bandwidth is infinite.</td>
<td>Bill Joy and Tom Lyon</td>
</tr>
<tr style="font-size: 12pt; font-family: verdana">
<td>
<i>4</i>
</td>

<td>The network is secure.</td>
<td>Bill Joy and Tom Lyon</td>
</tr>
<tr style="font-size: 12pt; font-family: verdana">
<td>
<i>5</i>
</td>
<td>Topology does not change.</td>
<td>Peter Deutsch</td>
</tr>
<tr style="font-size: 12pt; font-family: verdana">
<td>
<i>6</i>
</td>
<td>There is one administrator.</td>
<td>Peter Deutsch</td>
</tr>
<tr style="font-size: 12pt; font-family: verdana">
<td>
<i>7</i>
</td>
<td>Transport cost is zero.</td>
<td>Peter Deutsch</td>
</tr>
<tr style="font-size: 12pt; font-family: verdana">
<td>
<i>8</i>
</td>
<td>The network is homogeneous.</td>
<td>James Gosling</td>
</tr>
</table>
</body>
21
</html>

Put this html file into a Website
http://venus.sod.asu.edu/WSRepository/xml/Fallacies.html

22

Web Application:
Embed C# Code in Fallacies.aspx
<%@ Page Language="C#" %>
<%@ Import Namespace="System.Xml.XPath" %>
<%@ Import Namespace="System.Xml.Xsl" %>
<%
XPathDocument doc =
new XPathDocument (Server.MapPath ("Fallacies.xml"));
XslCompiledTransform xt = new XslCompiledTransform();
xt.Load (Server.MapPath ("Fallacies.xsl"));
xt.Transform(doc, null, Response.OutputStream);
%>
Send the return value as an
html stream to Web browser.

23

M9 L5
CSS:
Cascading Style Sheets

Lecture Outline
| Cascading Style Sheets in HTML
| Cascading Style Sheets in XML
| XHTML (Extensible HTML)?
| Development of Web Presentation
Languages

2

CSS: Cascading Style Sheets
In HTML, within an element tag:
<link REL="STYLESHEET" TYPE="text/css"
HREF="UrlOfCssStyleSheet">
◼ In XML: As a Processing Information (PI) the prologue of an
XML document:
<?xml-stylesheet href="UrlOfCssStyleSheet"
type="text/css"?>
◼

◼

Example (http://www.w3.org/Style/styling-XML.en.html):

<?xml-stylesheet href="common.css"?>
<?xml-stylesheet href="modern.css" title="Modern" media="screen"
type="text/css"?>
<?xml-stylesheet href="classic.css" alternate="yes" title="Classic"
media="screen, print" type="text/css"?>

3

CSS Language Rules
Element selected for applying the style

Style for
the
element

body
{
font-family:
color:
background:
margin:
}

Attribute

Arial;
blue;
yellow;
8px;

Value
4

HTML Example
common.css
body
{
font-family: Tahoma, Arial, sans-serif;
font-size: 14px;
color: blue;
background: yellow;
margin: 8px;
}
h1 {
font-size: 18px;
margin-top: 14px;
margin-bottom: 6px;
border-bottom: 2px solid black
}

HTML:
<link href=“common.css”
rel=“stylesheet”
type=“text/css” />
<body>
<h1>First Level Heading</h1>
One evening, just as he was getting
his flute ready and his musicians
were assembled, an officer brought
him a list of the strangers who had
arrived.
<h2>Second Level Heading</h2>
A new paragraph here.
</body>

5

CSS Application Example in XML Files
http://www.w3.org/Style/styling-XML.en.html

Define multiple CSS files to
switch the view of the page

<?xml-stylesheet href="common.css"?>
<?xml-stylesheet href="modern.css" title="Modern" media="screen"
type="text/css"?>
<?xml-stylesheet href="classic.css" alternate="yes" title="Classic"
media="screen, print" type="text/css"?>
<ARTICLE>
<HEADLINE> Fredrick the Great meets Bach </HEADLINE>
<AUTHOR>Johann Nikolaus Forkel</AUTHOR>
Define styles for
<PARA> One evening, just as he was getting his
the elements in
.css file
<INSTRUMENT>flute</INSTRUMENT>
ready and his musicians were assembled, an officer brought him
a list of the strangers who had arrived.
</PARA>
</ARTICLE>
6

What is XHTML (Extensible HTML)?
Problems with HTML:
◼ It has a fixed set of tags, and thus is not extensible;
◼ Many browser-specific tags are added.
◼ How can these problems be addressed?
◼ Add a document type definition file (DTD) or XSD schema
◼ XHTML allows three different ways to add a DTD file
◼ Strict DTD: Enforce the structure by restricting to those
tags defined in the DTD;
◼ Transitional DTD: Allow all the depreciated features/tags to
be migrated into the new page;
◼ Frameset DTD: Same as Transitional DTD, but replaced the
<body> with the <frame>, which allows developers to share
the frames in multiple pages.
◼

7

Application of XHTML in ASP .Net
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title>Vending Machine</title>
</head>
<body>
<form id="form1" runat="server">
<div>
Welcome to Soda Vending Machine. <br />
I take quarters and dollars.<br />
</div>
<asp:Button ID="Button1" runat="server" onclick="Button1_Click"
Text="Insert a Quarter" />
<asp:Button ID="Button2" runat="server" onclick="Button2_Click"
Text="Insert a Dollar" />
<p>
The amont you have depoted:
<asp:Label ID="lblAmount" runat="server" Text="0"></asp:Label>
</p>
<asp:Button ID="btnSoda" runat="server" onclick="Button3_Click"
Text="Buy a Soda" />
<asp:Label ID="lblSoda" runat="server" Text="[ ]"></asp:Label> <br />
<br />
<asp:Button ID="btnRtn" runat="server" onclick="Button4_Click"
Text="Return Deposit" />
<asp:Label ID="lblRtn" runat="server" Text="[
]"></asp:Label>
<br />
</form>
</body>
</html>

8

Development of Web Presentation Languages
1991 HTML
◼ 1994 HTML 2
◼ 1996 CSS 1 + JavaScript
◼ 1997 HTML 4
◼ 1998 CSS 2
◼ 2000 XHTML
JavaScript / JQuery
Animation can
◼ 2005 AJAX
be programmed
= XHTML + CSS + AJAX + Silverlight
◼ 2008 XAML
◼ 2009 HTML5 = HTML + CSS + JavaScript / JQuery
◼

Animation can
be programmed

9

